<table id="scoreboard">
  <thead>
    <tr>
      <th>Rank</th>
      <th>Name</th>
      <th>Division</th>
      <th>Category</th>
      <th>Time</th>
      <th>Date</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody id="scoreboardBody"></tbody>
</table>

<script>
  const scoreboardBody = document.getElementById("scoreboardBody");
  const columnMap = ['rank', 'name', 'division', 'category', 'time', 'date'];
  let entries = []; // assume this gets populated from Firestore
  let currentSort = { column: null, asc: true };

  function parseTimeToSeconds(timeStr) {
    const parts = timeStr.split(':').map(Number);
    return parts.reduce((acc, part) => acc * 60 + part, 0);
  }

  function renderScoreboard() {
    scoreboardBody.innerHTML = '';
    const now = new Date().toDateString();

    const sorted = [...entries];

    if (currentSort.column) {
      const { column, asc } = currentSort;
      sorted.sort((a, b) => {
        const getVal = (e) => {
          switch (column) {
            case 'name': return e.name.toLowerCase();
            case 'division': return e.division.toLowerCase();
            case 'category': return e.category.toLowerCase();
            case 'time': return parseTimeToSeconds(e.time);
            case 'date': return new Date(e.date);
            default: return parseTimeToSeconds(e.time);
          }
        };
        const aVal = getVal(a), bVal = getVal(b);
        if (aVal < bVal) return asc ? -1 : 1;
        if (aVal > bVal) return asc ? 1 : -1;
        return 0;
      });
    }

    sorted.forEach((entry, index) => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${index + 1}</td>
        <td>${entry.name}</td>
        <td>${entry.division}</td>
        <td>${entry.category}</td>
        <td>${entry.time}</td>
        <td>${entry.date}</td>
        <td><button onclick="deleteEntry('${entry.id}')">Delete</button></td>
      `;
      scoreboardBody.appendChild(row);
    });

    // Update header arrows
    document.querySelectorAll('#scoreboard thead th').forEach((header, i) => {
      if (i === 6) return; // Skip Actions
      const col = columnMap[i];
      header.textContent = col.charAt(0).toUpperCase() + col.slice(1);
      if (currentSort.column === col) {
        header.textContent += currentSort.asc ? ' ▲' : ' ▼';
      }
    });
  }

  document.querySelectorAll('#scoreboard thead th').forEach((header, i) => {
    if (i === 6) return; // Skip Actions column
    header.style.cursor = 'pointer';
    header.addEventListener('click', () => {
      const col = columnMap[i];
      if (currentSort.column === col) {
        currentSort.asc = !currentSort.asc;
      } else {
        currentSort.column = col;
        currentSort.asc = true;
      }
      renderScoreboard();
    });
  });

  function deleteEntry(id) {
    // delete logic here
  }

  // Populate entries and call renderScoreboard() when ready
</script>
